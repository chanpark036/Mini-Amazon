{% extends "base.html" %}

{% block content %}

<br><br>
<!-- START
<!-- start new  -->
<!-- <form action="{{url_for('products.productCategory')}}" method="post" novalidate> -->
  <!-- {{ form2.hidden_tag() }} -->
  <!-- <p>
    {{ form2.category.label }}<br/>
    {{ form2.category(size=32) }}<br/>
  </p>
  {{ form2.search(class_="btn btn-black") }}
</form> -->


<!-- <h2>PRODUCTS</h2>
<table class='table table-hover table-bordered container'>
  <thead class="thead-dark">
    <tr>
      <th scope="col">Product ID</th>
      <th scope="col">Product Name</th>
      <th scope="col">Price</th>
    </tr>
  </thead>
  <tbody>
    {% for product in products_by_category%}
      <tr>
        <th scope="row">{{product.id}}</th>
        <td>{{product.name}}</td>
        <td>{{product.price}}</td>
      </tr>
    {% endfor %}
  </tbody>
</table> -->
<!-- end new -->



<!-- Original -->
<!-- <form action="" method="post" novalidate>
  {{ form1.hidden_tag() }}
  <p>
    {{ form1.value.label }}<br/>
    {{ form1.value(size=32) }}<br/>
  </p>
  {{ form1.search(class_="btn btn-black") }}
</form> -->

<!-- <h2>Products for sale</h2> -->
<h2>SEARCH RESULTS FOR PRODUCTS</h2>
<table class='table table-hover table-bordered container' id="products-table">
  <thead class="thead-dark">
    <tr>
      <th scope="col">Product ID</th>
      <th scope="col">Product Name</th>
      <th scope="col">Price</th>
    </tr>
  </thead>
  <tbody>
    {% for product in avail_products%}
      <tr>
        <th scope="row">{{product.id}}</th>
        <td>{{product.name}}</td>
        <td>{{product.price}}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>


<br><br>
{% if current_user.is_authenticated %}
<h2>Your recent purchases:</h2>
<table class='table table-hover table-bordered container'>
  <thead class="thead-dark">
    <tr>
      <th scope="col">Purchase ID</th>
      <th scope="col">Product Name</th>
      <th scope="col">Price</th>
    </tr>
  </thead>
  <tbody>
    {% for purchase in purchase_history%}
      <tr>
        <th scope="row">{{purchase.id}}</th>
        <td>{{purchase.pid}}</td>
        <td>{{purchase.time_purchased}}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p><a href="{{ url_for('users.login') }}">Log in</a> to see your purchase history!</p>
{% endif %}

<script>
  $(document).ready( function () {
    // alert('hello')
      $('#products-table').DataTable();
  } );
</script>
{% endblock %}

